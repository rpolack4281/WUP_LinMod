---
title: "linear model from Web"
author: "Rachel Polack"
date: "Summer 2022"
output:
   html_document:
         toc: true
         toc_depth: 5
        
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Read about the data from the website where it is staged.  Then form three regression models; Model1 is SIMS~ARM, Model2 is SIMS~GRIP, and Model3 is SIMS~ARM+GRIP. For each model find a 95% prediction interval of SIMS given a value of 94  for GRIP and 88 for ARM. Compare Model1 with Model3 using anova. Write it up in a markdown document, push the project up to your github account and submit it back to canvas as link. 

 


```{r include=FALSE}
require(tidyverse)
require(tigerstats)
require(rgl)
require(knitr)

```

```{r}
data <- read.csv(file="https://onlinestatbook.com/case_studies_rvls/physical_strength/data.txt",sep="",header=TRUE)  

```

## Model 1 SIM~ARMS



### scatterplot
```{r}
basicNN <- ggplot(data,aes(y=SIMS,x=ARM))
```
```{r}
basicNN + geom_point()
```


It looks like there is an obvious linear relationship between SIMS and ARM. This means that the greater the arm strength of the worker, the better they preform on the simulations that were used to assess job performance. 


### Numerical results
```{r}
cor(SIMS~ARM,data=data)
```

The value above provides the specific correlation coefficient on the relationship between SIMS and ARM. The value 0.686 is quite decent in showing the positive linear relationship between SIMS and ARM. 

### Inferential  (Build model.1)
```{r}
model.1 <- lm(SIMS~ARM,data=data)
summary.lm(model.1)
```

The model above shows the linear model of the relationship between SIMS and ARM. The most important information that can be taken from the model are the residual standard error and the adjusted r-squared value. A low residual standard error value of 1.226 means that the values do not deviate largely from the predicted value. Moreover, based on the value of the adjusted r-squared, we're reducing the error from the mean model by 46.6%.

#### Predict at target point

```{r}
Targetpoint<- data.frame(ARM=88, GRIP=94)
```

```{r}
predict(model.1, Targetpoint, interval = "prediction")

```

This predicted the value we would get from model 1 if the target point for ARM is 88 and GRIP is 94. But given that this model only makes use of ARM, it disreguards the target point value for GRIP.


#### scatterplot with model fit

### Now add in scatterplot

```{r}
basicNN + geom_point()+geom_lm()
```
  
The scatter plot above now indicates the prediction line that was determined previously. It further establishes that the relationship creates a normal distribution wherein the 95% of all the point is within two residual values from the line of best fit. 


## Model 2 SIM~GRIP

```{r}
basicGRIP <- ggplot(data,aes(y=SIMS,x=GRIP))
```
```{r}
basicGRIP + geom_point()
```

Similar to the first model, there seems to be a positive liner between SIMS and GRIP. It means the greater the grip strength of a worker, the more likely they are to do well on the simulations.  



### Numerical results 

```{r}
cor(SIMS~GRIP,data=data)
```
The value above provides the specific correlation coefficient on the relationship between SIMS and GRIP although a value of 0.640 is quite decent in showing the positive linear relationship between SIMS and GRIP it is lower then that of the first model. Therefore, it points towards the idea that arm strength is a better variable in predicting a worker's performance in the simulation.

### Inferential  (Build model.2)

```{r}
model.2 <- lm(SIMS~GRIP,data=data)
summary.lm(model.2)
```  
Above is the linear model of the relationship between SIMS and GRIP, and it also shows the standard residual error value and the adjusted r-squared. Comparing these two values from those of the first model, we can expect that the standard deviation curve is wider on this model compared to the first one. Also the adjusted r-squared value on this model means that we're able to reduce the error from the mean model by 40.53% which is lower than that of the first model. Lastly, more of the error is explained by the first model compared to the second model, based on the residual standard error value.  


#### predict model.2 at target point

```{r}
predict(model.2, Targetpoint, interval = "prediction")

```

#### now add the model fit to our plot for model.2

```{r}
basicGRIP + geom_point()+geom_lm()
```

The scatter plot above combined the original data and the predicted values for SIMS~GRIP. Given all the information previously determined, this model specifically grip strength, is not as reliable in arm strength in predicting a worker's performance in simulations. 


## Model 3 SIM~ARM+GRIP

### Numerical results (cor)

```{r}
cor(SIMS~ARM+GRIP,data=data)
```

The value of the correlation coefficient of the third model is higher than those of the previous two. This indicates that this model may be better than the first two models, but further tests can be done to confirm this. 

  
### Inferential  (Build 2-dimentional model.3)

#### predict model.3 at target point
  

## Comparing nested models ANOVA Test

### Model.1 vs Model.3
### Model.2 vs Model.3

## Informally compare Model.1 with model.2

